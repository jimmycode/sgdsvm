



** RUNNING THE STOCHASTIC GRADIENT CRF ON THE CONLL CHUNKING TASK

The program "crfsgd" uses the same formats as CRF++ for 
template files and data files. These formats are explained
on the CRF++ page http://crfpp.sourceforge.net.
However, the program "crfsgd" wants gzipped data files
instead of plain text files. 


-- Usage.

$ ./crfsgd
Usage (training): crfsgd [options] model template traindata [devdata]
Usage (tagging):  crfsgd -t model testdata
Options for training:
 -c <num> : capacity control parameter (4.0)
 -f <num> : threshold on the occurences of each feature (3)
 -r <num> : total number of epochs (100)
 -h <num> : epochs between each testing phase (10)
 -e <cmd> : performance evaluation command (conlleval -q)
 -q       : silent mode



-- Training the model:
   Performance is evaluated on both sets every 10 epochs.
   This is convenient to see the how testing performance improves.

$ ./crfsgd -c 1.0 model.gz template \ 
        ../data/conll2000/train.txt.gz \
        ../data/conll2000/test.txt.gz
<...>
  sentences: 8936  outputs: 22
  cutoff: 3  features: 76329  parameters: 1679700
<...>
[Epoch 10] --  wnorm: 9040.78  training time: 128.63 seconds
Training perf:  sentences: 8936  losses: 5565.29  objective*n: 10085.7
accuracy:  99.18%; precision:  98.62%; recall:  98.55%; FB1:  98.58
Testing perf:  sentences: 2012  losses: 4594.2  objective*n: 5611.99
accuracy:  95.91%; precision:  93.62%; recall:  93.49%; FB1:  93.56
<...>
[Epoch 20] --  wnorm: 9665.89  training time: 238.74 seconds
Training perf:  sentences: 8936  losses: 4702.81  objective*n: 9535.75
accuracy:  99.49%; precision:  99.15%; recall:  99.04%; FB1:  99.10
Testing perf:  sentences: 2012  losses: 4517.71  objective*n: 5605.88
accuracy:  95.96%; precision:  93.75%; recall:  93.54%; FB1:  93.64
<...>
[Epoch 30] --  wnorm: 9763.05  training time: 349.09 seconds
Training perf:  sentences: 8936  losses: 4471.12  objective*n: 9352.65
accuracy:  99.59%; precision:  99.29%; recall:  99.18%; FB1:  99.23
Testing perf:  sentences: 2012  losses: 4484.38  objective*n: 5583.49
accuracy:  95.97%; precision:  93.76%; recall:  93.57%; FB1:  93.66
<...>
[Epoch 40] --  wnorm: 9768.18  training time: 459.57 seconds
Training perf:  sentences: 8936  losses: 4377.81  objective*n: 9261.9
accuracy:  99.63%; precision:  99.35%; recall:  99.23%; FB1:  99.29
Testing perf:  sentences: 2012  losses: 4465.48  objective*n: 5565.17
accuracy:  96.00%; precision:  93.83%; recall:  93.63%; FB1:  93.73
Saving model file model.gz.
Done!  459.57 seconds.


-- Testing the final model:

$ ./crfsgd -t model.gz ../data/conll2000/test.txt.gz | ./conlleval
processed 47377 tokens with 23852 phrases; found: 23801 phrases; correct: 22333.
accuracy:  96.00%; precision:  93.83%; recall:  93.63%; FB1:  93.73
             ADJP: precision:  80.10%; recall:  73.52%; FB1:  76.67  402
             ADVP: precision:  83.55%; recall:  80.95%; FB1:  82.23  839
            CONJP: precision:  55.56%; recall:  55.56%; FB1:  55.56  9
             INTJ: precision: 100.00%; recall:  50.00%; FB1:  66.67  1
              LST: precision:   0.00%; recall:   0.00%; FB1:   0.00  0
               NP: precision:  94.22%; recall:  94.08%; FB1:  94.15  12403
               PP: precision:  96.98%; recall:  97.57%; FB1:  97.27  4840
              PRT: precision:  75.89%; recall:  80.19%; FB1:  77.98  112
             SBAR: precision:  87.31%; recall:  86.17%; FB1:  86.74  528
               VP: precision:  93.81%; recall:  93.99%; FB1:  93.90  4667


** COMPARATIVE EXPERIMENTS WITH CRF++


$ crf_learn -c 1.0 -f 3 template train.txt model
<...>
Number of sentences: 8936
Number of features:  1679700
<...>
iter=18 terr=0.04522 serr=0.45636 act=1679700 obj=24917.57905 diff=0.02882
<...>
iter=36 terr=0.02188 serr=0.27775 act=1679700 obj=13697.78077 diff=0.01717
<...>
iter=71 terr=0.00518 serr=0.09109 act=1679700 obj=9654.43394 diff=0.00167
<...>
iter=142 terr=0.00340 serr=0.06256 act=1679700 obj=9042.07254 diff=0.00007
Done!4335.34 s


$ crf_test -m model test.txt | tr '	' ' ' | ../../../conlleval 
processed 47377 tokens with 23852 phrases; found: 23799 phrases; correct: 22334.
accuracy:  96.02%; precision:  93.84%; recall:  93.64%; FB1:  93.74
             ADJP: precision:  79.71%; recall:  74.43%; FB1:  76.98  409
             ADVP: precision:  83.18%; recall:  81.06%; FB1:  82.11  844
            CONJP: precision:  55.56%; recall:  55.56%; FB1:  55.56  9
             INTJ: precision: 100.00%; recall:  50.00%; FB1:  66.67  1
              LST: precision:   0.00%; recall:   0.00%; FB1:   0.00  0
               NP: precision:  94.36%; recall:  94.03%; FB1:  94.19  12378
               PP: precision:  96.71%; recall:  97.82%; FB1:  97.26  4866
              PRT: precision:  79.05%; recall:  78.30%; FB1:  78.67  105
             SBAR: precision:  88.65%; recall:  84.67%; FB1:  86.62  511
               VP: precision:  93.63%; recall:  93.99%; FB1:  93.81  4676


